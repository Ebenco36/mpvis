{"ast":null,"code":"import { isNumber } from 'vega-util';\nimport { getViewConfigDiscreteStep } from '../../config';\nimport { isVgRangeStep } from '../../vega.schema';\nimport { getMarkPropOrConfig, signalOrValueRef } from '../common';\nimport * as encode from './encode';\nexport const tick = {\n  vgMark: 'rect',\n  encodeEntry: model => {\n    const {\n      config,\n      markDef\n    } = model;\n    const orient = markDef.orient;\n    const vgSizeChannel = orient === 'horizontal' ? 'width' : 'height';\n    const vgThicknessChannel = orient === 'horizontal' ? 'height' : 'width';\n    return {\n      ...encode.baseEncodeEntry(model, {\n        align: 'ignore',\n        baseline: 'ignore',\n        color: 'include',\n        orient: 'ignore',\n        size: 'ignore',\n        theta: 'ignore'\n      }),\n      ...encode.pointPosition('x', model, {\n        defaultPos: 'mid',\n        vgChannel: 'xc'\n      }),\n      ...encode.pointPosition('y', model, {\n        defaultPos: 'mid',\n        vgChannel: 'yc'\n      }),\n      // size / thickness => width / height\n      ...encode.nonPosition('size', model, {\n        defaultValue: defaultSize(model),\n        vgChannel: vgSizeChannel\n      }),\n      [vgThicknessChannel]: signalOrValueRef(getMarkPropOrConfig('thickness', markDef, config))\n    };\n  }\n};\nfunction defaultSize(model) {\n  const {\n    config,\n    markDef\n  } = model;\n  const {\n    orient\n  } = markDef;\n  const vgSizeChannel = orient === 'horizontal' ? 'width' : 'height';\n  const scale = model.getScaleComponent(orient === 'horizontal' ? 'x' : 'y');\n  const markPropOrConfig = getMarkPropOrConfig('size', markDef, config, {\n    vgChannel: vgSizeChannel\n  }) ?? config.tick.bandSize;\n  if (markPropOrConfig !== undefined) {\n    return markPropOrConfig;\n  } else {\n    const scaleRange = scale ? scale.get('range') : undefined;\n    if (scaleRange && isVgRangeStep(scaleRange) && isNumber(scaleRange.step)) {\n      return scaleRange.step * 3 / 4;\n    }\n    const defaultViewStep = getViewConfigDiscreteStep(config.view, vgSizeChannel);\n    return defaultViewStep * 3 / 4;\n  }\n}","map":{"version":3,"names":["isNumber","getViewConfigDiscreteStep","isVgRangeStep","getMarkPropOrConfig","signalOrValueRef","encode","tick","vgMark","encodeEntry","model","config","markDef","orient","vgSizeChannel","vgThicknessChannel","baseEncodeEntry","align","baseline","color","size","theta","pointPosition","defaultPos","vgChannel","nonPosition","defaultValue","defaultSize","scale","getScaleComponent","markPropOrConfig","bandSize","undefined","scaleRange","get","step","defaultViewStep","view"],"sources":["../../../../src/compile/mark/tick.ts"],"sourcesContent":[null],"mappings":"AACA,SAAQA,QAAQ,QAAO,WAAW;AAClC,SAAQC,yBAAyB,QAAO,cAAc;AACtD,SAAQC,aAAa,QAAO,mBAAmB;AAC/C,SAAQC,mBAAmB,EAAEC,gBAAgB,QAAO,WAAW;AAG/D,OAAO,KAAKC,MAAM,MAAM,UAAU;AAElC,OAAO,MAAMC,IAAI,GAAiB;EAChCC,MAAM,EAAE,MAAM;EAEdC,WAAW,EAAGC,KAAgB,IAAI;IAChC,MAAM;MAACC,MAAM;MAAEC;IAAO,CAAC,GAAGF,KAAK;IAC/B,MAAMG,MAAM,GAAGD,OAAO,CAACC,MAAM;IAE7B,MAAMC,aAAa,GAAGD,MAAM,KAAK,YAAY,GAAG,OAAO,GAAG,QAAQ;IAClE,MAAME,kBAAkB,GAAGF,MAAM,KAAK,YAAY,GAAG,QAAQ,GAAG,OAAO;IAEvE,OAAO;MACL,GAAGP,MAAM,CAACU,eAAe,CAACN,KAAK,EAAE;QAC/BO,KAAK,EAAE,QAAQ;QACfC,QAAQ,EAAE,QAAQ;QAClBC,KAAK,EAAE,SAAS;QAChBN,MAAM,EAAE,QAAQ;QAChBO,IAAI,EAAE,QAAQ;QACdC,KAAK,EAAE;OACR,CAAC;MAEF,GAAGf,MAAM,CAACgB,aAAa,CAAC,GAAG,EAAEZ,KAAK,EAAE;QAACa,UAAU,EAAE,KAAK;QAAEC,SAAS,EAAE;MAAI,CAAC,CAAC;MACzE,GAAGlB,MAAM,CAACgB,aAAa,CAAC,GAAG,EAAEZ,KAAK,EAAE;QAACa,UAAU,EAAE,KAAK;QAAEC,SAAS,EAAE;MAAI,CAAC,CAAC;MAEzE;MACA,GAAGlB,MAAM,CAACmB,WAAW,CAAC,MAAM,EAAEf,KAAK,EAAE;QACnCgB,YAAY,EAAEC,WAAW,CAACjB,KAAK,CAAC;QAChCc,SAAS,EAAEV;OACZ,CAAC;MACF,CAACC,kBAAkB,GAAGV,gBAAgB,CAACD,mBAAmB,CAAC,WAAW,EAAEQ,OAAO,EAAED,MAAM,CAAC;KACzF;EACH;CACD;AAED,SAASgB,WAAWA,CAACjB,KAAgB;EACnC,MAAM;IAACC,MAAM;IAAEC;EAAO,CAAC,GAAGF,KAAK;EAC/B,MAAM;IAACG;EAAM,CAAC,GAAGD,OAAO;EAExB,MAAME,aAAa,GAAGD,MAAM,KAAK,YAAY,GAAG,OAAO,GAAG,QAAQ;EAClE,MAAMe,KAAK,GAAGlB,KAAK,CAACmB,iBAAiB,CAAChB,MAAM,KAAK,YAAY,GAAG,GAAG,GAAG,GAAG,CAAC;EAE1E,MAAMiB,gBAAgB,GACpB1B,mBAAmB,CAAC,MAAM,EAAEQ,OAAO,EAAED,MAAM,EAAE;IAACa,SAAS,EAAEV;EAAa,CAAC,CAAC,IAAIH,MAAM,CAACJ,IAAI,CAACwB,QAAQ;EAElG,IAAID,gBAAgB,KAAKE,SAAS,EAAE;IAClC,OAAOF,gBAAgB;GACxB,MAAM;IACL,MAAMG,UAAU,GAAGL,KAAK,GAAGA,KAAK,CAACM,GAAG,CAAC,OAAO,CAAC,GAAGF,SAAS;IACzD,IAAIC,UAAU,IAAI9B,aAAa,CAAC8B,UAAU,CAAC,IAAIhC,QAAQ,CAACgC,UAAU,CAACE,IAAI,CAAC,EAAE;MACxE,OAAQF,UAAU,CAACE,IAAI,GAAG,CAAC,GAAI,CAAC;;IAGlC,MAAMC,eAAe,GAAGlC,yBAAyB,CAACS,MAAM,CAAC0B,IAAI,EAAEvB,aAAa,CAAC;IAE7E,OAAQsB,eAAe,GAAG,CAAC,GAAI,CAAC;;AAEpC"},"metadata":{},"sourceType":"module","externalDependencies":[]}