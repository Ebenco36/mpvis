{"ast":null,"code":"import { signalOrValueRef } from '../../common';\nimport { midPoint } from './valueref';\nexport function positionOffset({\n  channel: baseChannel,\n  markDef,\n  encoding = {},\n  model,\n  bandPosition\n}) {\n  const channel = `${baseChannel}Offset`; // Need to cast as the type can't be inferred automatically\n  const defaultValue = markDef[channel];\n  const channelDef = encoding[channel];\n  if ((channel === 'xOffset' || channel === 'yOffset') && channelDef) {\n    const ref = midPoint({\n      channel: channel,\n      channelDef,\n      markDef,\n      config: model?.config,\n      scaleName: model.scaleName(channel),\n      scale: model.getScaleComponent(channel),\n      stack: null,\n      defaultRef: signalOrValueRef(defaultValue),\n      bandPosition\n    });\n    return {\n      offsetType: 'encoding',\n      offset: ref\n    };\n  }\n  const markDefOffsetValue = markDef[channel];\n  if (markDefOffsetValue) {\n    return {\n      offsetType: 'visual',\n      offset: markDefOffsetValue\n    };\n  }\n  return {};\n}","map":{"version":3,"names":["signalOrValueRef","midPoint","positionOffset","channel","baseChannel","markDef","encoding","model","bandPosition","defaultValue","channelDef","ref","config","scaleName","scale","getScaleComponent","stack","defaultRef","offsetType","offset","markDefOffsetValue"],"sources":["../../../../../src/compile/mark/encode/offset.ts"],"sourcesContent":[null],"mappings":"AAQA,SAAQA,gBAAgB,QAAO,cAAc;AAE7C,SAAQC,QAAQ,QAAO,YAAY;AAOnC,OAAM,SAAUC,cAAcA,CAAC;EAC7BC,OAAO,EAAEC,WAAW;EACpBC,OAAO;EACPC,QAAQ,GAAG,EAAE;EACbC,KAAK;EACLC;AAAY,CAOb;EACC,MAAML,OAAO,GAAG,GAAGC,WAAW,QAQX,CAAC,CAAC;EAErB,MAAMK,YAAY,GAAGJ,OAAO,CAACF,OAAO,CAAC;EACrC,MAAMO,UAAU,GAAGJ,QAAQ,CAACH,OAAO,CAAC;EAEpC,IAAI,CAACA,OAAO,KAAK,SAAS,IAAIA,OAAO,KAAK,SAAS,KAAKO,UAAU,EAAE;IAClE,MAAMC,GAAG,GAAGV,QAAQ,CAAC;MACnBE,OAAO,EAAEA,OAAO;MAChBO,UAAU;MACVL,OAAO;MACPO,MAAM,EAAEL,KAAK,EAAEK,MAAM;MACrBC,SAAS,EAAEN,KAAK,CAACM,SAAS,CAACV,OAAO,CAAC;MACnCW,KAAK,EAAEP,KAAK,CAACQ,iBAAiB,CAACZ,OAAO,CAAC;MACvCa,KAAK,EAAE,IAAI;MACXC,UAAU,EAAEjB,gBAAgB,CAACS,YAAY,CAAC;MAC1CD;KACD,CAAC;IACF,OAAO;MAACU,UAAU,EAAE,UAAU;MAAEC,MAAM,EAAER;IAAG,CAAC;;EAG9C,MAAMS,kBAAkB,GAAGf,OAAO,CAACF,OAAO,CAAC;EAC3C,IAAIiB,kBAAkB,EAAE;IACtB,OAAO;MAACF,UAAU,EAAE,QAAQ;MAAEC,MAAM,EAAEC;IAAkB,CAAC;;EAG3D,OAAO,EAAE;AACX"},"metadata":{},"sourceType":"module","externalDependencies":[]}